<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>dotwhisker: Remaking the Examples from Kastellec and Leoni (2007) • dotwhisker</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="dotwhisker: Remaking the Examples from Kastellec and Leoni (2007)">
<meta property="og:description" content="dotwhisker">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dotwhisker</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dotwhisker-vignette.html">dotwhisker: Dot-and-Whisker Plots of Regression Results</a>
    </li>
    <li>
      <a href="../articles/kl2007_examples.html">dotwhisker: Remaking the Examples from Kastellec and Leoni (2007)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fsolt/dotwhisker/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>dotwhisker: Remaking the Examples from Kastellec
and Leoni (2007)</h1>
                        <h4 data-toc-skip class="author">Frederick
Solt</h4>
            
            <h4 data-toc-skip class="date">2024-05-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fsolt/dotwhisker/blob/HEAD/vignettes/kl2007_examples.Rmd" class="external-link"><code>vignettes/kl2007_examples.Rmd</code></a></small>
      <div class="hidden name"><code>kl2007_examples.Rmd</code></div>

    </div>

    
    
<p>I have been a big fan of <span class="citation">Kastellec and Leoni
(2007)</span> since it came out, and <a href="https://jkastellec.scholar.princeton.edu/" class="external-link">by putting their code
for creating graphs from actually-published tables online</a>, the
authors allowed me and many others to adapt it for our own needs. But
there can be no doubt that the code is cumbersome and that it takes a
lot of fiddly work to get it to produce the desired results, work that
likely contributes to the continued reliance in political science on
tables to present regression results. As they acknowledged then, “it
simply takes more work to produce graphs” than tables <span class="citation">(Kastellec and Leoni 2007, 757)</span>. Just eight-plus
years later(!), the <code>dotwhisker</code> package, building on many
other developments in the <code>R</code> ecosystem, arrived to make
producing effective plots of regression results nearly effortless.</p>
<p>Below, I present their original code for their three examples of
plotting regression results, along with similar plots done using
<code>dotwhisker</code>. I hope you’ll agree that the latter plots are
not only much easier to make, but also—thanks to Hadley Wickham’s <span class="citation">(2009)</span> <code>ggplot</code>—better looking (and
more easily further customizable).</p>
<div class="section level3">
<h3 id="figure-6-presenting-a-single-regression-model-using-a-dot-plot-with-error-bars-">Figure 6: Presenting a Single Regression Model Using a Dot Plot with
Error Bars.<a class="anchor" aria-label="anchor" href="#figure-6-presenting-a-single-regression-model-using-a-dot-plot-with-error-bars-"></a>
</h3>
<p>Kastellec and Leoni’s original code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create vectors for coefficients, standard errors and variable names </span></span>
<span>    <span class="co">#we place coefficient as last element in each vector rather than 1st</span></span>
<span>    <span class="co">#since it is least important predictor, and thus we place it at the bottom of the graph</span></span>
<span><span class="co">#note: we exclude the constant, since it is substantively meaningless</span></span>
<span></span>
<span><span class="va">coef.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1.31</span>, <span class="fl">.93</span>, <span class="fl">1.46</span>, <span class="fl">.07</span>, <span class="fl">.96</span>, <span class="fl">.2</span>, <span class="fl">.22</span>, <span class="op">-</span><span class="fl">.21</span>, <span class="op">-</span><span class="fl">.32</span>, <span class="op">-</span><span class="fl">.27</span>,<span class="fl">.23</span>, </span>
<span>    <span class="fl">0</span>, <span class="op">-</span><span class="fl">.03</span>, <span class="fl">.13</span>, <span class="fl">.15</span>, <span class="fl">.31</span>, <span class="op">-</span><span class="fl">.10</span><span class="op">)</span></span>
<span><span class="va">se.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">.33</span>, <span class="fl">.32</span>, <span class="fl">.32</span>, <span class="fl">.37</span>, <span class="fl">.37</span>, <span class="fl">.13</span>, <span class="fl">.12</span>, <span class="fl">.12</span>, <span class="fl">.12</span>, <span class="fl">.07</span>, <span class="fl">.07</span>, <span class="fl">.01</span>, <span class="fl">.21</span>,</span>
<span>    <span class="fl">.14</span>, <span class="fl">.29</span>, <span class="fl">.25</span>, <span class="fl">.27</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Argentina"</span>, <span class="st">"Chile"</span>, <span class="st">"Colombia"</span>, <span class="st">"Mexico"</span>, <span class="st">"Venezuela"</span>, <span class="co">#for longer names, we split into 2 lines using "\n" function</span></span>
<span>    <span class="st">"Retrospective Egocentric"</span>, <span class="st">"Prospective Egocentric"</span>,</span>
<span>    <span class="st">"Retrospective Sociotropic"</span>, <span class="st">"Prospective Sociotropic"</span>,</span>
<span>    <span class="st">"Distance from President"</span>, <span class="st">"Ideology"</span>, <span class="st">"Age"</span>, <span class="st">"Female"</span>, <span class="st">"Education"</span>,</span>
<span>    <span class="st">"Academic Sector"</span>, <span class="st">"Business Sector"</span>, <span class="st">"Government Sector"</span><span class="op">)</span></span>
<span></span>
<span>    </span>
<span><span class="va">y.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">coef.vec</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="co">#create indicator for y.axis, descending so that R orders vars from top to bottom on y-axis</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">13</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="co">#set margins for plot, leaving lots of room on left-margin (2nd number in margin command) for variable names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coef.vec</span>, <span class="va">y.axis</span>, type <span class="op">=</span> <span class="st">"p"</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">1.2</span>,<span class="co">#plot coefficients as points, turning off axes and labels. </span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2.5</span><span class="op">)</span>, xaxs <span class="op">=</span> <span class="st">"r"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="co">#set limits of x-axis so that they include mins and maxs of </span></span>
<span>        <span class="co">#coefficients + .95% confidence intervals and plot is symmetric; use "internal axes", and leave plot title empty</span></span>
<span><span class="co">#the 3 lines below create horiztonal lines for 95% confidence intervals, and vertical ticks for 90% intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">coef.vec</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec</span>, <span class="va">y.axis</span>, <span class="va">coef.vec</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec</span>, <span class="va">y.axis</span>, lwd <span class="op">=</span>  <span class="fl">1.5</span><span class="op">)</span><span class="co">#coef +/-1.96*se = 95% interval, lwd adjusts line thickness</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,by<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="cn">NA</span>, tick <span class="op">=</span> <span class="cn">T</span>,<span class="co">#draw x-axis and labels with tick marks</span></span>
<span>    cex.axis <span class="op">=</span> <span class="fl">1.2</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">.7</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="co">#reduce label size, moves labels closer to tick marks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,  <span class="op">-</span><span class="fl">1</span>,  <span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, tick <span class="op">=</span> <span class="cn">T</span>,<span class="co">#draw x-axis and labels with tick marks</span></span>
<span>    cex.axis <span class="op">=</span> <span class="fl">1.2</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">.7</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="co">#reduce label size, moves labels closer to tick marks    </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="va">y.axis</span>, label <span class="op">=</span> <span class="va">var.names</span>, las <span class="op">=</span> <span class="fl">1</span>, tick <span class="op">=</span> <span class="cn">T</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">.6</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>    cex.axis <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="co">#draw y-axis with tick marks, make labels perpendicular to axis and closer to axis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">17</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># draw dotted line through 0</span></span>
<span><span class="co">#box(bty = "l") #place box around plot</span></span>
<span></span>
<span><span class="co">#use following code to place model info into plot region</span></span>
<span><span class="va">x.height</span> <span class="op">&lt;-</span> <span class="fl">.57</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x.height</span>, <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">^</span><span class="op">{</span><span class="fl">2</span><span class="op">}</span> <span class="op">==</span> <span class="fl">.15</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#add text for R-squared</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x.height</span>, <span class="fl">9</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Adjusted "</span>, <span class="va">R</span><span class="op">^</span><span class="op">{</span><span class="fl">2</span><span class="op">}</span> <span class="op">==</span> <span class="st">".12"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="co">#add text for Adjusted-R-squared</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x.height</span>, <span class="fl">8</span>, <span class="st">"n = 500"</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="co">#add text for sample size</span></span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Redone using <code>dotwhisker</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("dotwhisker") # uncomment to install from CRAN</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dotwhisker</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format data as tidy dataframe</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>term<span class="op">=</span><span class="va">var.names</span>, estimate<span class="op">=</span><span class="va">coef.vec</span>,</span>
<span>                               std.error<span class="op">=</span><span class="va">se.vec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw dot-and-whisker plot</span></span>
<span><span class="va">results_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/dwplot.html">dwplot</a></span><span class="op">(</span>show_stats <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Determinants of Authoritarian Aggression\nStevens, Bishin, and Barr (2006)\nvia Kastellec and Leoni (2007)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.05</span>, y <span class="op">=</span> <span class="fl">10</span>, size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             label <span class="op">=</span> <span class="st">"R^2 == .15"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.05</span>, y <span class="op">=</span> <span class="fl">9</span>, size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             label <span class="op">=</span> <span class="st">"Adjusted~R^2 == .12"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.05</span>, y <span class="op">=</span> <span class="fl">8</span>, size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              label <span class="op">=</span> <span class="st">"n = 500"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="figure-7-using-parallel-dot-plots-with-error-bars-to-present-two-regression-models-">Figure 7: Using Parallel Dot Plots with Error Bars to Present Two
Regression Models.<a class="anchor" aria-label="anchor" href="#figure-7-using-parallel-dot-plots-with-error-bars-to-present-two-regression-models-"></a>
</h3>
<p>Kastellec and Leoni’s original code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create Vectors for coefs and standard errors for each model, and variable names</span></span>
<span>    <span class="co">#note that we  exclude "margin squared" since it doesn't appear in either model</span></span>
<span></span>
<span><span class="va">coef.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.039</span>, <span class="cn">NA</span>, <span class="fl">.048</span>, <span class="op">-</span><span class="fl">.133</span>, <span class="fl">.071</span>, <span class="op">-</span><span class="fl">.795</span>, <span class="fl">1.47</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.036</span>, <span class="cn">NA</span>, <span class="fl">.036</span>, <span class="op">-</span><span class="fl">.142</span>, <span class="fl">.07</span>, <span class="op">-</span><span class="fl">.834</span>, <span class="fl">1.70</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.051</span>, <span class="cn">NA</span>, <span class="fl">.017</span>, <span class="fl">.05</span>, <span class="fl">.011</span>, <span class="op">-</span><span class="fl">.532</span>, <span class="fl">.775</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.037</span>, <span class="op">-</span><span class="fl">.02</span>, <span class="fl">.047</span>, <span class="op">-</span><span class="fl">.131</span>,<span class="fl">.072</span>, <span class="op">-</span><span class="fl">.783</span>, <span class="fl">1.45</span>,</span>
<span>                        <span class="op">-</span><span class="fl">.034</span>, <span class="op">-</span><span class="fl">.018</span>, <span class="op">-</span><span class="fl">.035</span>, <span class="op">-</span><span class="fl">.139</span>, <span class="fl">.071</span>, <span class="op">-</span><span class="fl">.822</span>, <span class="fl">1.68</span>,</span>
<span>                        <span class="op">-</span><span class="fl">.05</span>, <span class="op">-</span><span class="fl">.023</span>, <span class="fl">.016</span>,<span class="op">-</span><span class="fl">.049</span>, <span class="fl">.013</span>, <span class="op">-</span><span class="fl">.521</span>, <span class="fl">.819</span><span class="op">)</span>,nr<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">## R2 of the models</span></span>
<span><span class="va">R2</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.910</span>,  <span class="fl">0.910</span>,  <span class="fl">0.940</span>,  <span class="fl">0.910</span>,  <span class="fl">0.910</span>,  <span class="fl">0.940</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##standard error matrix, n.variables x n.models</span></span>
<span><span class="va">se.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.003</span>, <span class="cn">NA</span>, <span class="fl">.011</span>, <span class="fl">.013</span>, <span class="fl">.028</span>, <span class="fl">.056</span>, <span class="fl">.152</span>, <span class="fl">.003</span>, <span class="cn">NA</span>, <span class="fl">.012</span>, <span class="fl">.014</span>, <span class="fl">.029</span>, <span class="fl">.059</span>, <span class="fl">.171</span>, <span class="fl">.003</span>, <span class="cn">NA</span>,</span>
<span>                      <span class="fl">.01</span>, <span class="fl">.013</span>, <span class="fl">.024</span>, <span class="fl">.044</span>, <span class="fl">.124</span>, <span class="fl">.003</span>, <span class="fl">.005</span>, <span class="fl">.011</span>, <span class="fl">.013</span>, <span class="fl">.028</span>, <span class="fl">.055</span>, <span class="fl">.152</span>, <span class="fl">.003</span>, <span class="fl">.005</span>, <span class="fl">.021</span>, <span class="fl">.014</span>,</span>
<span>                      <span class="fl">.029</span>, <span class="fl">.059</span>, <span class="fl">.17</span>, <span class="fl">.003</span>,<span class="fl">.006</span>, <span class="fl">.01</span>, <span class="fl">.013</span>, <span class="fl">.024</span>, <span class="fl">.044</span>, <span class="fl">.127</span><span class="op">)</span>,nr<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##variable names</span></span>
<span><span class="va">coef.vec.1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="op">-</span><span class="fl">0.19</span>,<span class="op">-</span><span class="fl">0.39</span>,<span class="op">-</span><span class="fl">0.09</span>, <span class="cn">NA</span>, <span class="fl">0.04</span>,<span class="op">-</span><span class="fl">0.86</span>, <span class="fl">0.39</span>,<span class="op">-</span><span class="fl">3.76</span>, <span class="op">-</span><span class="fl">1.61</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.34</span>, <span class="op">-</span><span class="fl">1.17</span>, <span class="op">-</span><span class="fl">1.15</span>,<span class="op">-</span><span class="fl">1.52</span>, <span class="op">-</span><span class="fl">1.66</span>, <span class="op">-</span><span class="fl">1.34</span>,<span class="op">-</span><span class="fl">2.89</span>,<span class="op">-</span><span class="fl">1.88</span>,<span class="op">-</span><span class="fl">1.08</span>, <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">se.vec.1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.22</span>, <span class="fl">0.22</span>, <span class="fl">0.18</span>,<span class="fl">.29</span>, <span class="cn">NA</span>, <span class="fl">0.08</span>,<span class="fl">0.26</span>,<span class="fl">0.29</span>,<span class="fl">0.36</span>,<span class="fl">.19</span>,<span class="fl">0.19</span>, <span class="fl">0.22</span>,</span>
<span>    <span class="fl">0.22</span>,<span class="fl">0.25</span>,<span class="fl">0.28</span>,<span class="fl">0.32</span>,<span class="fl">0.48</span>, <span class="fl">0.43</span>,<span class="fl">0.41</span>, <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">coef.vec.2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.27</span>,<span class="op">-</span><span class="fl">0.19</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0.005</span>, <span class="fl">0.04</span>,<span class="op">-</span><span class="fl">0.98</span>,<span class="op">-</span><span class="fl">.36</span>,<span class="op">-</span><span class="fl">3.66</span>, <span class="op">-</span><span class="fl">1.59</span>,</span>
<span>     <span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">1.24</span>, <span class="op">-</span><span class="fl">1.04</span>, <span class="op">-</span><span class="fl">1.83</span>, <span class="op">-</span><span class="fl">1.82</span>, <span class="op">-</span><span class="fl">1.21</span>, <span class="op">-</span><span class="fl">2.77</span>, <span class="op">-</span><span class="fl">1.34</span>, <span class="op">-</span><span class="fl">0.94</span>, <span class="fl">0.13</span><span class="op">)</span></span>
<span><span class="va">se.vec.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.22</span>,<span class="fl">0.24</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0.004</span>, <span class="fl">0.09</span> , <span class="fl">.31</span> , <span class="fl">.30</span> , <span class="fl">.37</span> , <span class="fl">.21</span> , <span class="fl">.21</span> , <span class="fl">.24</span> , <span class="fl">.24</span>,</span>
<span>     <span class="fl">.29</span> , <span class="fl">.32</span> , <span class="fl">.33</span> , <span class="fl">.49</span> , <span class="fl">.46</span> , <span class="fl">.49</span> , <span class="fl">.26</span><span class="op">)</span></span>
<span><span class="va">var.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zombie"</span> , <span class="st">"SMD Only"</span>, <span class="st">"PR Only"</span>, <span class="st">"Costa Rican in PR"</span>, </span>
<span>    <span class="st">"Vote Share Margin"</span>, <span class="st">"Urban-Rural Index"</span>,<span class="st">"No Factional\nMembership"</span>,</span>
<span>    <span class="st">"Legal Professional"</span>, <span class="st">"1st Term"</span>, <span class="st">"2nd Term"</span>, <span class="st">"4th Term"</span>,</span>
<span>    <span class="st">"5th Term"</span>,<span class="st">"6th Term"</span>,<span class="st">"7th Term"</span>,<span class="st">"8th Term"</span>,<span class="st">"9th Term"</span>,<span class="st">"10th Term"</span>,</span>
<span>    <span class="st">"11th Term"</span>,<span class="st">"12th Term"</span>, <span class="st">"Constant"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var.names</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="co">#create indicator for y.axis, descending so that R orders vars from top to bottom on y-axis</span></span>
<span><span class="va">adjust</span> <span class="op">&lt;-</span> <span class="fl">.15</span> <span class="co">#create object that we will use to adjust points and lines up and down to distinguish between models</span></span>
<span>    </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co">#in order to add variable categories and braces to left side of plot, </span></span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="co">#we use layout command, create a small second panel on left side.</span></span>
<span>                <span class="co">#using c(2,1) in matrix command tells R to create right panel 1st</span></span>
<span><span class="co">#layout.show(2) #can use this command to check results of layout command (but it must be commented out when creating PDF).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">.5</span>,<span class="fl">1</span><span class="op">)</span>, lheight <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span><span class="co">#set margins for regression plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coef.vec.1</span>, <span class="va">y.axis</span><span class="op">+</span><span class="va">adjust</span>, type <span class="op">=</span> <span class="st">"p"</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, <span class="co">#plot model 1 coefs using black points (pch = 19, default = black), adding the "adjust amount" to the y.axis indicator to move points up</span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="op">(</span><span class="va">coef.vec.1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.1</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span>, <span class="op">(</span><span class="va">coef.vec.2</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.2</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="co">#set xlims at mins and maximums (from both models) of confidence intervals, plus .1 to leave room at ends of plots</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="op">(</span><span class="va">coef.vec.1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.1</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span>, <span class="op">(</span><span class="va">coef.vec.2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.2</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>,  <span class="co">#use na.rm=T since vectors have missing values</span></span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y.axis</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y.axis</span><span class="op">)</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>,at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">.8</span>,<span class="fl">1</span><span class="op">)</span>, cex.axis <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span><span class="co">#add x-axis and labels; "pretty" creates a sequence of  equally spaced nice values that cover the range of the values in 'x'-- in this case, integers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="va">y.axis</span>, label <span class="op">=</span> <span class="va">var.names</span>, las <span class="op">=</span> <span class="fl">1</span>, tick <span class="op">=</span> <span class="cn">T</span>, cex.axis <span class="op">=</span><span class="fl">1.3</span><span class="op">)</span><span class="co">#add y-axis and labels; las = 1 makes labels perpendicular to y-axis</span></span>
<span><span class="co">#axis(3,pretty(coef.vec.1, 3))#same as x-axis, but on top axis </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">y.axis</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">.5</span>, col <span class="op">=</span> <span class="st">"light grey"</span><span class="op">)</span><span class="co">#draw light dotted line at each variable for dotplot effect</span></span>
<span><span class="co">#box(bty="l")#draw box around plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">coef.vec.1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.1</span>, <span class="va">y.axis</span><span class="op">+</span><span class="va">adjust</span>, <span class="va">coef.vec.1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.1</span>, <span class="va">y.axis</span><span class="op">+</span><span class="va">adjust</span>, lwd <span class="op">=</span>  <span class="fl">1.3</span><span class="op">)</span><span class="co">#draw lines connecting 95% confidence intervals</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># draw dotted line through 0 for reference line for null significance hypothesis testing</span></span>
<span></span>
<span><span class="co">#add 2nd model</span></span>
<span>    <span class="co">#because we are using white points and do want the lines to go "through" points rather than over them</span></span>
<span>        <span class="co">#we draw lines first and the overlay points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">coef.vec.2</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.2</span>, <span class="va">y.axis</span><span class="op">-</span><span class="va">adjust</span>, <span class="va">coef.vec.2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.vec.2</span>, <span class="va">y.axis</span><span class="op">-</span><span class="va">adjust</span>, lwd <span class="op">=</span>  <span class="fl">1.3</span><span class="op">)</span><span class="co">#draw lines connecting 95% confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">coef.vec.2</span>, <span class="va">y.axis</span><span class="op">-</span><span class="va">adjust</span>, pch <span class="op">=</span> <span class="fl">21</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, bg <span class="op">=</span> <span class="st">"white"</span> <span class="op">)</span> <span class="co">#add point estimates for 2nd model; pch = 21 uses for overlay points, and "white" for white color</span></span>
<span></span>
<span><span class="co">#add legend (manually) to identify which dots denote model 1 and which denote model 2</span></span>
<span><span class="co">#legend(-4.5, 20, c("Model 1", "Model 2"), pch = c(19,21),bty = "n")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">19.5</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex  <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.7</span>, <span class="fl">19.5</span>, <span class="st">"Model 1"</span>, adj <span class="op">=</span> <span class="fl">0</span>,cex  <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="co">#left-justify text using adj  = 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">18.5</span>, pch <span class="op">=</span> <span class="fl">21</span>,cex  <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.7</span>, <span class="fl">18.5</span>, <span class="st">"Model 2"</span>, adj <span class="op">=</span> <span class="fl">0</span>,cex  <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="co">#left-justify text using adj  = 0</span></span>
<span></span>
<span><span class="co">#Create Variable Categories and Braces to go in 2nd plot</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co">#set margins--- bottom (1st number) and top (3rd number) must be the same as in 1st plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var.names</span><span class="op">)</span><span class="op">)</span>, <span class="va">y.axis</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">F</span>,  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="co">#call empty plot using type="n"</span></span>
<span>    <span class="co">#use a sequence of length 20 so that x and y have same length</span></span>
<span></span>
<span><span class="va">left.side</span> <span class="op">&lt;-</span> <span class="fl">.55</span><span class="co">#use this to manipulate how far segments are from y-axis</span></span>
<span>    <span class="co">#note:  getting braces and text in proper place requires much trial and error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">20.2</span>,<span class="va">left.side</span>,<span class="fl">16.5</span><span class="op">)</span> <span class="co">#add brackets around MP Type vars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">20.2</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">20.2</span><span class="op">)</span> <span class="co">#1 segment at a time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">16.5</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">16.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">18.5</span>, <span class="st">"MP Type"</span>, srt <span class="op">=</span> <span class="fl">90</span>, font <span class="op">=</span> <span class="fl">3</span>, cex  <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="co">#Add text; "srt" rotates to 90 degrees, font = 3 == italics</span></span>
<span></span>
<span><span class="co">#don't add "Electoral Strength" since it's only 1 variable</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">15.5</span>,<span class="va">left.side</span>,<span class="fl">12.3</span><span class="op">)</span> <span class="co">#add brackets around "Misc Controls"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">15.5</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">15.5</span><span class="op">)</span> <span class="co">#one segment at a time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">12.3</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">12.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">14</span>, <span class="st">"Misc\nControls"</span>, srt <span class="op">=</span> <span class="fl">90</span>, font <span class="op">=</span> <span class="fl">3</span>, cex  <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="co">#Add text; "srt" rotates to 90 degrees, font = 3 == italics</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">12.15</span>,<span class="va">left.side</span>,<span class="fl">1.8</span><span class="op">)</span> <span class="co">#add brackets around "Seniority"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">12.15</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">12.15</span><span class="op">)</span>   <span class="co">#one segment at a time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">left.side</span>,<span class="fl">1.8</span>,<span class="va">left.side</span><span class="op">+</span><span class="fl">.15</span>,<span class="fl">1.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">7</span>, <span class="st">"Seniority"</span>, srt <span class="op">=</span> <span class="fl">90</span>, font <span class="op">=</span> <span class="fl">3</span>, cex  <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="co">#Add text; "srt" rotates to 90 degrees, font = 3 == italics</span></span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Redone using <code>dotwhisker</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Format data as tidy dataframe</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">var.names</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                         estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">coef.vec.1</span>, <span class="va">coef.vec.2</span><span class="op">)</span>,</span>
<span>                         std.error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se.vec.1</span>, <span class="va">se.vec.2</span><span class="op">)</span>,</span>
<span>                         model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Model 1"</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Model 2"</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw dot-and-whisker plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dwplot.html">dwplot</a></span><span class="op">(</span><span class="va">results_df</span>, show_stats <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">.993</span><span class="op">)</span>, legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">.99</span><span class="op">)</span>,</span>
<span>           legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.background <span class="op">=</span></span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"gray90"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Logit Coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Electoral Incentives and LDP Post Allocation\nPekkanen, Nyblade, and Krause (2006)\nvia Kastellec and Leoni (2007)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add brackets</span></span>
<span><span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/add_brackets.html">add_brackets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MP Type"</span>, <span class="st">"Zombie"</span>, <span class="st">"Costa Rican in PR"</span><span class="op">)</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Misc Controls"</span>, <span class="st">"Urban-Rural Index"</span>, <span class="st">"Legal Professional"</span><span class="op">)</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Seniority"</span>, <span class="st">"1st Term"</span>, <span class="st">"12th Term"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="figure-8-using-small-multiple-plots-to-present-regression-results-from-several-models-">Figure 8: Using “Small Multiple” Plots to Present Regression Results
from Several Models.<a class="anchor" aria-label="anchor" href="#figure-8-using-small-multiple-plots-to-present-regression-results-from-several-models-"></a>
</h3>
<p>Kastellec and Leoni’s original code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##point estimates, in a n.variables, n.variables x n.models</span></span>
<span><span class="va">coef.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.039</span>, <span class="cn">NA</span>, <span class="fl">.048</span>, <span class="op">-</span><span class="fl">.133</span>, <span class="fl">.071</span>, <span class="op">-</span><span class="fl">.795</span>, <span class="fl">1.47</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.036</span>, <span class="cn">NA</span>, <span class="fl">.036</span>, <span class="op">-</span><span class="fl">.142</span>, <span class="fl">.07</span>, <span class="op">-</span><span class="fl">.834</span>, <span class="fl">1.70</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.051</span>, <span class="cn">NA</span>, <span class="fl">.017</span>, <span class="fl">.05</span>, <span class="fl">.011</span>, <span class="op">-</span><span class="fl">.532</span>, <span class="fl">.775</span>, </span>
<span>                        <span class="op">-</span><span class="fl">.037</span>, <span class="op">-</span><span class="fl">.02</span>, <span class="fl">.047</span>, <span class="op">-</span><span class="fl">.131</span>,<span class="fl">.072</span>, <span class="op">-</span><span class="fl">.783</span>, <span class="fl">1.45</span>,</span>
<span>                        <span class="op">-</span><span class="fl">.034</span>, <span class="op">-</span><span class="fl">.018</span>, <span class="op">-</span><span class="fl">.035</span>, <span class="op">-</span><span class="fl">.139</span>, <span class="fl">.071</span>, <span class="op">-</span><span class="fl">.822</span>, <span class="fl">1.68</span>,</span>
<span>                        <span class="op">-</span><span class="fl">.05</span>, <span class="op">-</span><span class="fl">.023</span>, <span class="fl">.016</span>,<span class="op">-</span><span class="fl">.049</span>, <span class="fl">.013</span>, <span class="op">-</span><span class="fl">.521</span>, <span class="fl">.819</span><span class="op">)</span>,nr<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">## R2 of the models</span></span>
<span><span class="va">R2</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.910</span>,  <span class="fl">0.910</span>,  <span class="fl">0.940</span>,  <span class="fl">0.910</span>,  <span class="fl">0.910</span>,  <span class="fl">0.940</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##standard error matrix, n.variables x n.models</span></span>
<span><span class="va">se.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.003</span>, <span class="cn">NA</span>, <span class="fl">.011</span>, <span class="fl">.013</span>, <span class="fl">.028</span>, <span class="fl">.056</span>, <span class="fl">.152</span>, <span class="fl">.003</span>, <span class="cn">NA</span>, <span class="fl">.012</span>, <span class="fl">.014</span>, <span class="fl">.029</span>, <span class="fl">.059</span>, <span class="fl">.171</span>, <span class="fl">.003</span>, <span class="cn">NA</span>,</span>
<span>                      <span class="fl">.01</span>, <span class="fl">.013</span>, <span class="fl">.024</span>, <span class="fl">.044</span>, <span class="fl">.124</span>, <span class="fl">.003</span>, <span class="fl">.005</span>, <span class="fl">.011</span>, <span class="fl">.013</span>, <span class="fl">.028</span>, <span class="fl">.055</span>, <span class="fl">.152</span>, <span class="fl">.003</span>, <span class="fl">.005</span>, <span class="fl">.021</span>, <span class="fl">.014</span>,</span>
<span>                      <span class="fl">.029</span>, <span class="fl">.059</span>, <span class="fl">.17</span>, <span class="fl">.003</span>,<span class="fl">.006</span>, <span class="fl">.01</span>, <span class="fl">.013</span>, <span class="fl">.024</span>, <span class="fl">.044</span>, <span class="fl">.127</span><span class="op">)</span>,nr<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##variable names</span></span>
<span><span class="va">varnames</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"% of county\nregistration"</span>, <span class="st">"Law change"</span>, <span class="st">"Log population"</span>, <span class="st">"Log median\nfamily income"</span>,</span>
<span>             <span class="st">"% population with\nh.s. education"</span> ,<span class="st">"% population\nAfrican American"</span> ,<span class="st">"Constant"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">##exclude intercept</span></span>
<span><span class="va">coef.matrix</span><span class="op">&lt;-</span><span class="va">coef.matrix</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">se.matrix</span><span class="op">&lt;-</span><span class="va">se.matrix</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## each panel has at most six models, plotted in pairs.</span></span>
<span><span class="co">## in each pair, solid circles will be the models with "law change" in the specification</span></span>
<span><span class="co">## empty circles, those without "law change"</span></span>
<span></span>
<span><span class="co">##we are making a list, define it first as empty</span></span>
<span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length<span class="op">=</span><span class="fl">0</span>,mode<span class="op">=</span><span class="st">"list"</span><span class="op">)</span></span>
<span><span class="co">#estimates with law change (in the 4th to 6th columns)</span></span>
<span><span class="va">Y1</span><span class="op">$</span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">##95% confidence intervals</span></span>
<span><span class="va">Y1</span><span class="op">$</span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">Y1</span><span class="op">$</span><span class="va">hi</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">##90% confidence intervals</span></span>
<span><span class="va">Y1</span><span class="op">$</span><span class="va">lo1</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">Y1</span><span class="op">$</span><span class="va">hi1</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">##name the rows of Y1 estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y1</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">varnames</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span><span class="op">]</span> <span class="co">##no intercept</span></span>
<span></span>
<span></span>
<span><span class="co">#estimates without law change</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length<span class="op">=</span><span class="fl">0</span>,mode<span class="op">=</span><span class="st">"list"</span><span class="op">)</span></span>
<span><span class="va">Y2</span><span class="op">$</span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">Y2</span><span class="op">$</span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">Y2</span><span class="op">$</span><span class="va">hi</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">Y2</span><span class="op">$</span><span class="va">lo1</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.95</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">Y2</span><span class="op">$</span><span class="va">hi1</span> <span class="op">&lt;-</span> <span class="va">coef.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.95</span><span class="op">)</span><span class="op">*</span><span class="va">se.matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">varnames</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="co">##code from http://svn.tables2graphs.com/tables2graphs/Rcode/plotReg.R</span></span>
<span><span class="co">##The main function is plot.reg. It is called as follows  </span></span>
<span><span class="va">plot.reg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>,</span>
<span>                                        <span class="co">#a list composed by three or five matrices, all k x m.</span></span>
<span>                                        <span class="co">#where k is the number of independent variables</span></span>
<span>                                        <span class="co">#and m is the number of models</span></span>
<span>                                        <span class="co">#the matrices are: estimate, lo and hi;</span></span>
<span>                                        <span class="co">#and optionally lo1 and hi1</span></span>
<span>                                        <span class="co">#lo and hi are the low and upper bounds of the</span></span>
<span>                                        <span class="co">#confidence intervals</span></span>
<span>                                        <span class="co">#similarly</span></span>
<span>                                        <span class="co">#lo1 and hi1 are the inner confidence intervals</span></span>
<span>                                        <span class="co">#which will be plotted as cross hairs</span></span>
<span>                     <span class="va">Y2</span><span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                                        <span class="co">#specified just as Y</span></span>
<span>                                        <span class="co">#so one can plot the models in pairs (see examples)</span></span>
<span>                     <span class="va">legend</span><span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                                        <span class="co">#if there both Y and Y2 are specified, legend</span></span>
<span>                                        <span class="co">#is an optional character vector of length 2</span></span>
<span>                                        <span class="co">#giving the legends for Y and Y2</span></span>
<span>                     <span class="va">print</span><span class="op">=</span><span class="cn">TRUE</span>,        <span class="co"># print the plot or just create the object</span></span>
<span>                     <span class="va">refline</span><span class="op">=</span><span class="cn">NA</span>,         <span class="co"># a vector with the reference lines for each independent variable</span></span>
<span>                                        <span class="co"># put NA if you don't want ref lines</span></span>
<span>                     <span class="va">hlast</span><span class="op">=</span><span class="fl">.1</span>,          <span class="co"># the amount of space (in proportion) left at the bottom of the graph</span></span>
<span>                                        <span class="co"># for the x-axis labels</span></span>
<span>                     <span class="va">lwd.fact</span><span class="op">=</span><span class="fl">1</span>,</span>
<span>                                        <span class="co"># a multiplier for the line width and character size</span></span>
<span>                     <span class="va">length.arrow</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>,<span class="st">"mm"</span><span class="op">)</span>,</span>
<span>                                        <span class="co"># length of the cross hair</span></span>
<span>                     <span class="va">widths</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.45</span>,<span class="fl">.45</span>,<span class="fl">.1</span><span class="op">)</span>,</span>
<span>                                        <span class="co"># widths in proportion of the graph.</span></span>
<span>                                        <span class="co"># (space for the independent variable labels,</span></span>
<span>                                        <span class="co"># space for the panels,</span></span>
<span>                                        <span class="co"># space for the y-axis labels)</span></span>
<span>                     <span class="va">rot.label.y</span><span class="op">=</span><span class="fl">0</span>,     <span class="co"># rotation of the independent variable labels</span></span>
<span>                     <span class="va">just.label.y</span><span class="op">=</span><span class="st">"right"</span>, <span class="co"># justification of the  independent variable labels</span></span>
<span>                     <span class="va">pos.label.y</span><span class="op">=</span><span class="fl">.97</span>,   <span class="co"># x position of the independent variable labels</span></span>
<span>                     <span class="va">pch.size</span><span class="op">=</span><span class="fl">0.5</span>,      <span class="co"># size of the symbols</span></span>
<span>                     <span class="va">h.grid</span><span class="op">=</span><span class="cn">FALSE</span>,       <span class="co"># plot horizontal grid</span></span>
<span>                     <span class="va">v.grid</span><span class="op">=</span><span class="cn">FALSE</span>,       <span class="co"># plot vertical grid</span></span>
<span>                     <span class="va">expand.factor</span><span class="op">=</span><span class="fl">0.25</span>, <span class="co"># factor by which to extend the plot range</span></span>
<span>                     <span class="va">expand.factor2</span><span class="op">=</span><span class="fl">0.1</span>, <span class="co"># factor by which to extend the plot range</span></span>
<span>                     <span class="va">leg.mult</span><span class="op">=</span><span class="fl">.7</span>,  <span class="co">#rel size of legend</span></span>
<span>                     <span class="va">leg.fontsize</span><span class="op">=</span><span class="fl">8</span>, <span class="co">## font size of legend</span></span>
<span>                     <span class="va">yaxis.at</span><span class="op">=</span><span class="cn">NULL</span>, <span class="co">## list with y axis tick-mark points,</span></span>
<span>                     <span class="va">ylabel</span><span class="op">=</span><span class="cn">NULL</span>, <span class="co">## list with y axis labels</span></span>
<span>                     <span class="co">##with length equal to the number of plots</span></span>
<span>                     <span class="va">...</span>                <span class="co"># other options passed to the grid.Vdotplot function</span></span>
<span>                     <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## the function gets the variable names from Y$estimate rownames</span></span>
<span>  <span class="va">label.vec.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="co">## number of independent variables</span></span>
<span>  <span class="va">n.plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">yaxis.at</span><span class="op">)</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yaxis.at</span><span class="op">)</span><span class="op">!=</span><span class="va">n.plots</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"length of yaxis.at must equal the number of plots"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">hbet</span> <span class="op">&lt;-</span> <span class="fl">.01</span> <span class="co"># amound of vertical space between plots</span></span>
<span>  <span class="va">hit</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">hlast</span><span class="op">-</span><span class="va">hbet</span><span class="op">*</span><span class="va">n.plots</span><span class="op">)</span><span class="op">/</span><span class="va">n.plots</span> <span class="co">#height of each plot</span></span>
<span>  <span class="va">sp.now</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#i f sp.now &gt; 0, the x-axis with labels is plotted</span></span>
<span>  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n.plots</span><span class="op">*</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># index of the plots and between spaces</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create a new page</span></span>
<span>  <span class="co">##a frame graphical object</span></span>
<span>  <span class="co">## it has k*2 vertical slots (one for each variable + one for each space between plots)</span></span>
<span>  <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.frame.html" class="external-link">frameGrob</a></span><span class="op">(</span>layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.layout.html" class="external-link">grid.layout</a></span><span class="op">(</span><span class="va">n.plots</span><span class="op">*</span><span class="fl">2</span>,</span>
<span>                    <span class="co">## and 3 horizontal slots (space for ind. variables labels,</span></span>
<span>                    <span class="co">## space for plots, space for yaxis labels)      </span></span>
<span>                    <span class="fl">3</span>,widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">widths</span>,<span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                    heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">hit</span>,<span class="va">hbet</span><span class="op">)</span>,<span class="va">n.plots</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="va">hit</span>,<span class="va">hlast</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="co">## loop to create panels</span></span>
<span>  <span class="co">## j indexes independent variables</span></span>
<span>  <span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">index</span><span class="op">)</span> <span class="op">{</span>  <span class="co">## i is the vertical slot position</span></span>
<span>    <span class="co">#create a dataframe with the data to plot now</span></span>
<span>    <span class="va">Y.now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimate<span class="op">=</span><span class="va">Y</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                        lo<span class="op">=</span><span class="va">Y</span><span class="op">$</span><span class="va">lo</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                        hi<span class="op">=</span><span class="va">Y</span><span class="op">$</span><span class="va">hi</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                        lo1<span class="op">=</span><span class="va">Y</span><span class="op">$</span><span class="va">lo1</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                        hi1<span class="op">=</span><span class="va">Y</span><span class="op">$</span><span class="va">hi1</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">)</span></span>
<span>    <span class="co">##similartly for Y2</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">)</span> <span class="va">Y2.now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimate<span class="op">=</span><span class="va">Y2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                                           lo<span class="op">=</span><span class="va">Y2</span><span class="op">$</span><span class="va">lo</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                                           hi<span class="op">=</span><span class="va">Y2</span><span class="op">$</span><span class="va">hi</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                                           lo1<span class="op">=</span><span class="va">Y2</span><span class="op">$</span><span class="va">lo1</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>,</span>
<span>                                           hi1<span class="op">=</span><span class="va">Y2</span><span class="op">$</span><span class="va">hi1</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">else</span> <span class="va">Y2.now</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="co">## if it is the bottom row, set sp.now to a positive value</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span><span class="op">)</span> <span class="va">sp.now</span> <span class="op">&lt;-</span> <span class="fl">.1</span>    </span>
<span>    <span class="co">##are we drawing a reference line?</span></span>
<span>    <span class="va">drawRef</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">refline</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="co">##place the plot</span></span>
<span>    <span class="co">##the actual plot object is created by the function grid.Vdotplot</span></span>
<span>    <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.place.html" class="external-link">placeGrob</a></span><span class="op">(</span><span class="va">fg</span>,</span>
<span>                    <span class="fu">grid.Vdotplot</span><span class="op">(</span><span class="va">Y.now</span>,</span>
<span>                                  <span class="va">Y2.now</span>,</span>
<span>                                  sp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="va">sp.now</span><span class="op">)</span>,draw<span class="op">=</span><span class="cn">FALSE</span>,lwd.fact<span class="op">=</span><span class="va">lwd.fact</span>,</span>
<span>                                  refline<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">drawRef</span>,<span class="va">refline</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span> <span class="co">## if refline is NA put anything in place</span></span>
<span>                                  ,drawRef<span class="op">=</span><span class="va">drawRef</span>,</span>
<span>                                  length.arrow<span class="op">=</span><span class="va">length.arrow</span>,</span>
<span>                                  pch.size<span class="op">=</span><span class="va">pch.size</span>,</span>
<span>                                  h.grid<span class="op">=</span><span class="va">h.grid</span>,</span>
<span>                                  v.grid<span class="op">=</span><span class="va">v.grid</span>,</span>
<span>                                  expand.factor<span class="op">=</span><span class="va">expand.factor</span>,</span>
<span>                                  expand.factor2<span class="op">=</span><span class="va">expand.factor2</span>,</span>
<span>                                  aty<span class="op">=</span><span class="va">yaxis.at</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                  labely<span class="op">=</span><span class="va">ylabel</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                  <span class="va">...</span><span class="op">)</span> </span>
<span>                    ,col<span class="op">=</span><span class="fl">2</span>,row<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span>    <span class="co">##the independent variables labels</span></span>
<span>    <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.place.html" class="external-link">placeGrob</a></span><span class="op">(</span><span class="va">fg</span>,<span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pos.label.y</span>,<span class="va">label.vec.vars</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>                                ,rot<span class="op">=</span><span class="va">rot.label.y</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">.75</span><span class="op">*</span><span class="va">lwd.fact</span><span class="op">)</span>,just<span class="op">=</span><span class="va">just.label.y</span></span>
<span>                                <span class="op">)</span>,col<span class="op">=</span><span class="fl">1</span>,row<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span>    <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">j</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## if Y2 exists and a legend is specified, draw it using the legendGrob function</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">&amp;</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">legend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.place.html" class="external-link">placeGrob</a></span><span class="op">(</span><span class="va">fg</span>,<span class="fu"><a href="https://rdrr.io/r/grid/legendGrob.html" class="external-link">legendGrob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">21</span><span class="op">)</span>,<span class="va">legend</span>,cex<span class="op">=</span><span class="va">leg.mult</span>,leg.fontsize<span class="op">=</span><span class="va">leg.fontsize</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"white"</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">1</span>,row<span class="op">=</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">print</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">fg</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co">## if we are not printing, return the graphical object</span></span>
<span>    <span class="va">fg</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">### grid.Vdotplot is what actually draws the plots</span></span>
<span><span class="co">### the arguments are explained in the plot.reg function</span></span>
<span><span class="va">grid.Vdotplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>,<span class="va">Y2</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">x</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">sp</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.1</span><span class="op">)</span>,<span class="va">draw</span><span class="op">=</span><span class="cn">TRUE</span>,<span class="va">refline</span><span class="op">=</span><span class="fl">0</span>,<span class="va">label.x</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">drawRef</span><span class="op">=</span><span class="cn">TRUE</span>,<span class="va">lwd.fact</span><span class="op">=</span><span class="fl">0.35</span>,<span class="va">length.arrow</span><span class="op">=</span><span class="fl">0</span>,<span class="va">pch.size</span><span class="op">=</span><span class="fl">0.5</span>,<span class="va">h.grid</span>,<span class="va">v.grid</span>,<span class="va">y1y2sep</span><span class="op">=</span><span class="fl">.1</span>,<span class="va">expand.factor</span>,<span class="va">expand.factor2</span>,<span class="va">aty</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">labely</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## function to plot point estimates</span></span>
<span>  <span class="va">estimates.grob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="co">#x coordinates</span></span>
<span>                             <span class="va">Y</span>, <span class="co">#Y$estimate has the y coordinates</span></span>
<span>                             <span class="va">fill</span><span class="op">=</span><span class="st">"black"</span> <span class="co">#color to fill the symbol</span></span>
<span>                             <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">## pointsGrob is a grid function</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">pointsGrob</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">Y</span><span class="op">$</span><span class="va">estimate</span>,pch<span class="op">=</span><span class="fl">21</span>,size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">pch.size</span>,<span class="st">"char"</span><span class="op">)</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">fill</span>,lwd<span class="op">=</span><span class="va">lwd.fact</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## function to plot confidence intervals</span></span>
<span>  <span class="va">ci.grob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ylo</span>,<span class="va">yhi</span>,<span class="va">x</span>,<span class="va">lwd</span><span class="op">=</span><span class="fl">2.5</span>,<span class="va">name</span><span class="op">=</span><span class="st">"ci"</span>,<span class="va">plot.arrow</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">##do we want the cross hairs at the ends?</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">plot.arrow</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">arrow.now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span>,length<span class="op">=</span><span class="va">length.arrow</span>,ends<span class="op">=</span><span class="st">"both"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">arrow.now</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co">## use the segmentsGrob function of grid to plot the error bars</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.segments.html" class="external-link">segmentsGrob</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">x</span>,x1<span class="op">=</span><span class="va">x</span>,y0<span class="op">=</span><span class="va">ylo</span>,y1<span class="op">=</span><span class="va">yhi</span>,</span>
<span>                 default.units<span class="op">=</span><span class="st">"native"</span>,</span>
<span>                 name<span class="op">=</span><span class="va">name</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span>                 ,arrow<span class="op">=</span><span class="va">arrow.now</span></span>
<span>                 <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">aty</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">##  tick-mark not supplied</span></span>
<span>    </span>
<span>    <span class="co">## calculate y axis ticks (and labels)</span></span>
<span>    <span class="co">## create a vector with all values in the plot</span></span>
<span>    <span class="va">aty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,<span class="va">refline</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co">## if there is a refline, we want to make the plot symmetric around it</span></span>
<span>    <span class="co">##aty &lt;- pretty(aty,5,min.n=5,high.u.bias=5)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">refline</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co">##maximum distance</span></span>
<span>      <span class="co">##mdist &lt;- max(abs(aty-refline),na.rm=TRUE)    </span></span>
<span>      <span class="va">aty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">aty</span>,<span class="fl">2</span>,min.n<span class="op">=</span><span class="fl">2</span>,high.u.bias<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="co">##cat(aty,"is aty a \n")    </span></span>
<span>      <span class="va">aty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">aty</span>,<span class="fl">2</span><span class="op">*</span><span class="va">refline</span><span class="op">-</span><span class="va">aty</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="co">##cat(aty,"is aty b \n")    </span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">aty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">aty</span>,<span class="fl">5</span>,min.n<span class="op">=</span><span class="fl">5</span>,high.u.bias<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co">## take out the highest and the lowest value, to minimize whitespace</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aty</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span>  <span class="op">{</span></span>
<span>      <span class="va">aty</span> <span class="op">&lt;-</span> <span class="va">aty</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aty</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="va">r.y</span> <span class="op">&lt;-</span> <span class="fu">range.e</span><span class="op">(</span><span class="va">aty</span>,<span class="va">expand.factor</span><span class="op">)</span> <span class="co">## expand the range, so as to include everything</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">r.y</span> <span class="op">&lt;-</span> <span class="fu">range.e</span><span class="op">(</span><span class="va">aty</span>,<span class="va">expand.factor2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co">##cat(aty,"is aty c \n")</span></span>
<span>    <span class="co">##aty &lt;- c(aty,-max(abs(aty)),max(abs(aty)))  </span></span>
<span>    <span class="co">##r.y &lt;- range(aty)</span></span>
<span>    <span class="co">## make sure we draw the horizontal grid in every interval in the plot</span></span>
<span>    <span class="co">## but not outside the plot area</span></span>
<span>    <span class="co">## some manual adjustment might be necessary</span></span>
<span>    <span class="va">aty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">aty</span><span class="op">&lt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">r.y</span><span class="op">)</span><span class="op">|</span><span class="va">aty</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">r.y</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="va">aty</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">r.y</span> <span class="op">&lt;-</span> <span class="fu">range.e</span><span class="op">(</span><span class="va">aty</span>,<span class="va">expand.factor</span><span class="op">)</span> <span class="co">## expand the range, so as to include everything</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## x axis. might have to change this. the default is simply</span></span>
<span>  <span class="co">## an index of the models in the x - axis</span></span>
<span>  <span class="co">## later we possibly want to make this continuous</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span>  <span class="co">##if (is.null(x)) x &lt;- c(.5,1.75,3)</span></span>
<span>  <span class="co">## save x values</span></span>
<span>  <span class="va">x.o</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="va">l.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="co">## if there is no label, we create one with the index</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">label.x</span><span class="op">)</span><span class="op">)</span> <span class="va">label.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>,<span class="va">x.o</span>,<span class="st">")"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>  </span>
<span>  <span class="co">## if there is a second set of values create x2=x+e and decrease x to x-e</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y1y2sep</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">-</span><span class="va">y1y2sep</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## horizontal grid</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">h.grid</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">hgrid</span> <span class="op">&lt;-</span>   <span class="fu"><a href="https://rdrr.io/r/grid/grid.segments.html" class="external-link">segmentsGrob</a></span><span class="op">(</span>x0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aty</span><span class="op">)</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                            x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aty</span><span class="op">)</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                            y0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">aty</span>,<span class="st">"native"</span><span class="op">)</span>,</span>
<span>                            y1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">aty</span>,<span class="st">"native"</span><span class="op">)</span>,</span>
<span>                            gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lty<span class="op">=</span><span class="st">"dotted"</span>,lwd<span class="op">=</span><span class="va">lwd.fact</span>,col<span class="op">=</span><span class="st">"lightgrey"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">hgrid</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## vertical grid</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">v.grid</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">##     vgrid &lt;-   segmentsGrob(y0=unit(rep(0,l.x),"npc"),</span></span>
<span>    <span class="co">##                             y1=unit(rep(1,l.x),"npc"),</span></span>
<span>    <span class="co">##                             x0=unit(x.o,"native"),</span></span>
<span>    <span class="co">##                             x1=unit(x.o,"native"),</span></span>
<span>    <span class="co">##                             gp=gpar(lty="dotted",lwd=lwd.fact,col="lightgrey"))</span></span>
<span>    <span class="va">vgrid</span> <span class="op">&lt;-</span>   <span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="va">l.x</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                        <span class="co">##x=unit(x.o[seq(2,l.x,1)],"native"),</span></span>
<span>                        x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">x.o</span>,<span class="st">"native"</span><span class="op">)</span>,</span>
<span>                        width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"native"</span><span class="op">)</span>,</span>
<span>                        gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lty<span class="op">=</span><span class="st">"dotted"</span>,lty<span class="op">=</span><span class="fl">0</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray90"</span>,<span class="st">"gray95"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">vgrid</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## ref line  </span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">drawRef</span><span class="op">)</span>  <span class="op">{</span></span>
<span>    <span class="va">refline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.segments.html" class="external-link">segmentsGrob</a></span><span class="op">(</span>x0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="st">"npc"</span><span class="op">)</span>,x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.99</span>,<span class="st">"npc"</span><span class="op">)</span>,y0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">refline</span>,<span class="st">"native"</span><span class="op">)</span>,y1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">refline</span>,<span class="st">"native"</span><span class="op">)</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">1</span><span class="op">*</span><span class="va">lwd.fact</span>,lty<span class="op">=</span><span class="st">"dashed"</span>,col<span class="op">=</span><span class="st">"grey20"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">refline</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">## store ci</span></span>
<span>  <span class="va">ci1a</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>  </span>
<span>  <span class="va">ci1b</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">ci2a</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">ci2b</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">points2</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="co">## if ncol(Y)=5 there are overlapping CIs. the second one here.</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span> <span class="va">ci1b</span> <span class="op">&lt;-</span>         <span class="fu">ci.grob</span><span class="op">(</span><span class="va">Y</span><span class="op">$</span><span class="va">hi1</span>,<span class="va">Y</span><span class="op">$</span><span class="va">lo1</span>,<span class="va">x</span>,lwd<span class="op">=</span><span class="fl">.8</span><span class="op">*</span><span class="va">lwd.fact</span>,name<span class="op">=</span><span class="st">"ci1b"</span>,plot.arrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co">## the first one here.</span></span>
<span>  <span class="va">ci1a</span> <span class="op">&lt;-</span> <span class="fu">ci.grob</span><span class="op">(</span><span class="va">Y</span><span class="op">$</span><span class="va">hi</span>,<span class="va">Y</span><span class="op">$</span><span class="va">lo</span>,<span class="va">x</span>,lwd<span class="op">=</span><span class="fl">1.2</span><span class="op">*</span><span class="va">lwd.fact</span>,name<span class="op">=</span><span class="st">"ci1a"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">## if ncol(Y2)=5 there are overlapping CIs. the second one here.    </span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span> <span class="va">ci2b</span> <span class="op">&lt;-</span> <span class="fu">ci.grob</span><span class="op">(</span><span class="va">Y2</span><span class="op">$</span><span class="va">hi1</span>,<span class="va">Y2</span><span class="op">$</span><span class="va">lo1</span>,<span class="va">x2</span>,lwd<span class="op">=</span><span class="fl">.8</span><span class="op">*</span><span class="va">lwd.fact</span>,name<span class="op">=</span><span class="st">"ci2b"</span>,plot.arrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co">## the first one here.    </span></span>
<span>    <span class="va">ci2a</span> <span class="op">&lt;-</span> <span class="fu">ci.grob</span><span class="op">(</span><span class="va">Y2</span><span class="op">$</span><span class="va">hi</span>,<span class="va">Y2</span><span class="op">$</span><span class="va">lo</span>,<span class="va">x2</span>,lwd<span class="op">=</span><span class="fl">1.2</span><span class="op">*</span><span class="va">lwd.fact</span>,name<span class="op">=</span><span class="st">"ci2a"</span><span class="op">)</span></span>
<span>    <span class="co">## point estimates here</span></span>
<span>    <span class="va">points2</span> <span class="op">&lt;-</span> <span class="fu">estimates.grob</span><span class="op">(</span><span class="va">x2</span>,<span class="va">Y2</span>,fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">labely</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">labely</span> <span class="op">&lt;-</span> <span class="va">aty</span></span>
<span>    <span class="co">##print(paste("labely is ",labely,is.null(labely)))    </span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">gplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Y</span>,</span>
<span>                <span class="co">## gTree is a graphical object with the whole plot</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span></span>
<span>                      children<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span></span>
<span>                        <span class="va">hgrid</span>,<span class="va">vgrid</span>,</span>
<span>                        <span class="va">refline</span>,</span>
<span>                        <span class="va">ci1a</span>,</span>
<span>                        <span class="va">ci1b</span>,</span>
<span>                        <span class="fu">estimates.grob</span><span class="op">(</span><span class="va">x</span>,<span class="va">Y</span><span class="op">)</span>,</span>
<span>                        <span class="co">## if Y2</span></span>
<span>                        <span class="va">ci2a</span>,</span>
<span>                        <span class="va">ci2b</span></span>
<span>                        ,<span class="va">points2</span></span>
<span>                        <span class="co">## box/rectangle around the plot area</span></span>
<span>                        <span class="co">##,rectGrob(gp=gpar(lwd=.5*lwd.fact))</span></span>
<span>                        <span class="co">## plot x axis if sp2&gt;0 (we name it xaxis, so we can refer to it later)</span></span>
<span>                        ,<span class="kw">if</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.xaxis.html" class="external-link">xaxisGrob</a></span><span class="op">(</span>at<span class="op">=</span><span class="va">x.o</span>,label<span class="op">=</span><span class="va">label.x</span>,name<span class="op">=</span><span class="st">"xaxis"</span>,</span>
<span>                                gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="va">lwd.fact</span>,lwd<span class="op">=</span><span class="fl">0.6</span><span class="op">*</span><span class="va">lwd.fact</span><span class="op">)</span><span class="op">)</span></span>
<span>                        <span class="co">## plot x axis with no labels if it is not the bottom plot</span></span>
<span>                        ,<span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="op">!</span><span class="va">v.grid</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.xaxis.html" class="external-link">xaxisGrob</a></span><span class="op">(</span>at<span class="op">=</span><span class="va">x.o</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x.o</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="va">lwd.fact</span>,lwd<span class="op">=</span><span class="fl">0.6</span><span class="op">*</span><span class="va">lwd.fact</span><span class="op">)</span><span class="op">)</span></span>
<span>                        <span class="co">## plot y-axis if sp1&gt;0</span></span>
<span>                        ,<span class="kw">if</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.yaxis.html" class="external-link">yaxisGrob</a></span><span class="op">(</span>at<span class="op">=</span><span class="va">aty</span>,label<span class="op">=</span><span class="va">labely</span>,</span>
<span>                                gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.7</span><span class="op">*</span><span class="va">lwd.fact</span>,lwd<span class="op">=</span><span class="fl">0.6</span><span class="op">*</span><span class="va">lwd.fact</span><span class="op">)</span>,main<span class="op">=</span><span class="cn">FALSE</span>,name<span class="op">=</span><span class="st">"yaxis"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="co">## definition of the viewport (plot area)</span></span>
<span>                      vp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span>, </span>
<span>                        height<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                        <span class="co">##xscale=c(1,nrow(Y)),</span></span>
<span>                        xscale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>                        yscale<span class="op">=</span><span class="va">r.y</span></span>
<span>                        <span class="co">##yscale=c(-.1,.1)</span></span>
<span>                        ,clip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>                      <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">draw</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">##draw the plot</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.frame.html" class="external-link">frameGrob</a></span><span class="op">(</span>layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.layout.html" class="external-link">grid.layout</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span>,heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"npc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.place.html" class="external-link">placeGrob</a></span><span class="op">(</span><span class="va">fg</span>,<span class="va">gplot</span>,col<span class="op">=</span><span class="fl">2</span>,row<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">fg</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">gplot</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">##function to create legend (adapted from Murrell R Graphics book)</span></span>
<span><span class="va">legendGrob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pch</span>, <span class="co">## what symbol to use</span></span>
<span>                       <span class="va">labels</span>, <span class="co">## the text</span></span>
<span>                       <span class="va">hgap</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"lines"</span><span class="op">)</span>, <span class="co">#horizontal gap                       </span></span>
<span>                       <span class="va">vgap</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"lines"</span><span class="op">)</span>, <span class="co">#vertical gap</span></span>
<span>                       <span class="va">default.units</span> <span class="op">=</span> <span class="st">"lines"</span>, <span class="co">#default units </span></span>
<span>                       <span class="va">vp</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">#what viewport to use</span></span>
<span>                       <span class="va">cex</span><span class="op">=</span><span class="fl">1</span>, <span class="co">#character expansion</span></span>
<span>                       <span class="va">leg.fontsize</span><span class="op">=</span><span class="fl">8</span>,</span>
<span>                       <span class="va">fill</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">nkeys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span></span>
<span>  <span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.frame.html" class="external-link">frameGrob</a></span><span class="op">(</span>vp <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nkeys</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">symbol.border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.c.html" class="external-link">unit.c</a></span><span class="op">(</span><span class="va">vgap</span>, <span class="va">hgap</span>,</span>
<span>                              <span class="va">vgap</span>, <span class="va">hgap</span><span class="op">)</span></span>
<span>      <span class="va">text.border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.c.html" class="external-link">unit.c</a></span><span class="op">(</span><span class="va">vgap</span>, <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                                       <span class="st">"npc"</span><span class="op">)</span>, <span class="va">vgap</span>, <span class="va">hgap</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">symbol.border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.c.html" class="external-link">unit.c</a></span><span class="op">(</span><span class="va">vgap</span>, <span class="va">hgap</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, <span class="va">hgap</span><span class="op">)</span></span>
<span>      <span class="va">text.border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.c.html" class="external-link">unit.c</a></span><span class="op">(</span><span class="va">vgap</span>, <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                                       <span class="st">"npc"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, <span class="va">hgap</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.pack.html" class="external-link">packGrob</a></span><span class="op">(</span><span class="va">gf</span>, <span class="fu"><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">pointsGrob</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>,</span>
<span>                                  pch <span class="op">=</span> <span class="va">pch</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>cex<span class="op">=</span><span class="va">cex</span>,fill<span class="op">=</span><span class="va">fill</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span>, row <span class="op">=</span> <span class="va">i</span>, border <span class="op">=</span> <span class="va">symbol.border</span>,</span>
<span>                   width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                               <span class="st">"lines"</span><span class="op">)</span>, force.width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.pack.html" class="external-link">packGrob</a></span><span class="op">(</span><span class="va">gf</span>, <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span><span class="va">labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                             x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0.5</span>, just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"centre"</span><span class="op">)</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="va">leg.fontsize</span>,lineheight<span class="op">=</span><span class="fl">.9</span><span class="op">)</span><span class="op">)</span>,</span>
<span> col <span class="op">=</span> <span class="fl">2</span>, row <span class="op">=</span> <span class="va">i</span>, border <span class="op">=</span> <span class="va">text.border</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="va">gf</span></span>
<span> <span class="op">}</span></span>
<span></span>
<span><span class="co">##function to plot the legend</span></span>
<span><span class="va">grid.legend</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pch</span>, <span class="va">labels</span>, <span class="va">frame</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         <span class="va">hgap</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span>, <span class="va">vgap</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>                         <span class="va">default.units</span> <span class="op">=</span> <span class="st">"lines"</span>, <span class="va">draw</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">vp</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>  <span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/legendGrob.html" class="external-link">legendGrob</a></span><span class="op">(</span><span class="va">pch</span>, <span class="va">labels</span>, <span class="va">frame</span>, <span class="va">hgap</span>,</span>
<span>                    <span class="va">vgap</span>, <span class="va">default.units</span>, <span class="va">vp</span><span class="op">)</span></span>
<span>   <span class="kw">if</span> <span class="op">(</span><span class="va">draw</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">gf</span><span class="op">)</span></span>
<span>   <span class="va">gf</span></span>
<span> <span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">range.e</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">xp</span><span class="op">=</span><span class="fl">.1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">##expand the range by a fixed proportion</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">r.e</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">xp</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">r.e</span>,<span class="va">r</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">r.e</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## create the graph (do not print it yet)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">plot.reg</span><span class="op">(</span><span class="va">Y1</span>,<span class="va">Y2</span>,<span class="co">#the lists</span></span>
<span>                <span class="co">#the model labels</span></span>
<span>                label.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full Sample"</span>,<span class="st">"Excluding counties\nw. partial registration"</span>,</span>
<span>                  <span class="st">"Full sample w. \nstate year dummies"</span><span class="op">)</span>,</span>
<span>                <span class="co">## reference lines</span></span>
<span>                refline<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                <span class="co">## space left in the bottom (for the x-axis labels)</span></span>
<span>                hlast<span class="op">=</span><span class="fl">.15</span>,</span>
<span>                <span class="co">## print the graph?</span></span>
<span>                print<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                <span class="co">## line width / character size multiplier</span></span>
<span>                lwd.fact<span class="op">=</span><span class="fl">1.3</span>,</span>
<span>                <span class="co">## length of the cross- hairs</span></span>
<span>                length.arrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>,<span class="st">"mm"</span><span class="op">)</span>,</span>
<span>                <span class="co">## legend</span></span>
<span>                <span class="co">##legend=c("without law change","with law change"),</span></span>
<span>                <span class="co">## widths: variable names, plot size, y-axis</span></span>
<span>                widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.6</span>,<span class="fl">.4</span>,<span class="fl">.3</span><span class="op">)</span>,</span>
<span>                <span class="co">## rotation of the variable name labes</span></span>
<span>                rot.label.y<span class="op">=</span><span class="fl">0</span>,</span>
<span>                <span class="co">## justification of the variable name labels</span></span>
<span>                just.label.y<span class="op">=</span><span class="st">"right"</span>,</span>
<span>                <span class="co">## position (x-axis) of the variable name labels)</span></span>
<span>                pos.label.y<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                <span class="co">## size of the symbol</span></span>
<span>                pch.size<span class="op">=</span><span class="fl">0.6</span>,expand.factor<span class="op">=</span><span class="fl">.2</span>,expand.factor2<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                <span class="co">##legend</span></span>
<span>                legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"With law\nchange dummy"</span>,<span class="st">"Without law\nchange dummy"</span><span class="op">)</span>,leg.mult<span class="op">=</span><span class="fl">.7</span>,</span>
<span>                <span class="co">##legend font size</span></span>
<span>                leg.fontsize<span class="op">=</span><span class="fl">11</span>,</span>
<span>                v.grid<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                yaxis.at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                <span class="cn">NULL</span>,</span>
<span>                <span class="cn">NULL</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>,<span class="fl">.1</span>,<span class="fl">.05</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.2</span>,<span class="fl">.2</span>,<span class="fl">.1</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.2</span>,<span class="fl">.2</span>,<span class="fl">.1</span><span class="op">)</span>,</span>
<span>                <span class="cn">NULL</span><span class="co">##seq(-1,1,.5)</span></span>
<span>                <span class="op">)</span></span>
<span>                <span class="op">)</span></span>
<span><span class="co">## we rotate the labels of the x-axis 45 degrees. The grid utilities allow</span></span>
<span><span class="co">## this modification "on the fly", and it is easy if you are careful at naming the paths</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.edit.html" class="external-link">editGrob</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fu"><a href="https://rdrr.io/r/grid/gPath.html" class="external-link">gPath</a></span><span class="op">(</span><span class="st">"xaxis"</span>,<span class="st">"labels"</span><span class="op">)</span>,rot<span class="op">=</span><span class="fl">45</span>,just<span class="op">=</span><span class="st">"right"</span>,gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lineheight<span class="op">=</span><span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##tmp is the object we have just created,"xaxis" is the name of element in the object with the x-axis</span></span>
<span><span class="co">##elements, and "labels" is the actual object in xaxis that we want to rotate</span></span>
<span><span class="co">##just is the justification of the text</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span> <span class="co">## print the graph</span></span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>Redone using <code>dotwhisker</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Format data as tidy dataframe</span></span>
<span><span class="va">model_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full Sample\n"</span>,</span>
<span>                       <span class="st">"Excluding counties\nw/ partial registration\n"</span>,</span>
<span>                       <span class="st">"Full sample w/\nstate year dummies\n"</span><span class="op">)</span></span>
<span><span class="va">submodel_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"With"</span>,<span class="st">"Without"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">varnames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                         estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">coef.matrix</span><span class="op">[</span>, <span class="va">model_order</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                         std.error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">se.matrix</span><span class="op">[</span>, <span class="va">model_order</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                         model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">model_names</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         submodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">submodel_names</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/small_multiple.html">small_multiple</a></span><span class="op">(</span><span class="va">results_df</span>, show_stats <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="va">model_names</span><span class="op">)</span> <span class="op">+</span> <span class="co"># order the models </span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Coefficient Estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.97</span>, <span class="fl">.99</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>          legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>          legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"gray90"</span><span class="op">)</span>,</span>
<span>          legend.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>          legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_hue.html" class="external-link">scale_colour_hue</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Law Change\nDummy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registration Effects on Turnout\nAnsolabehere and Konisky (2006)\nvia Kastellec and Leoni (2007)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="kl2007_examples_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="affiliation">Affiliation<a class="anchor" aria-label="anchor" href="#affiliation"></a>
</h2>
<p>Frederick Solt</p>
<p>Department of Political Science,</p>
<p>University of Iowa,</p>
<p>324 Schaeffer Hall,</p>
<p>20 E Washington St, Iowa City, IA, 52242</p>
<p>Email: <a href="mailto:frederick-solt@uiowa.edu" class="email">frederick-solt@uiowa.edu</a></p>
<p>Website: <a href="https://fsolt.org" class="external-link uri">https://fsolt.org</a></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Kastellec2007" class="csl-entry">
Kastellec, Jonathan P., and Eduardo L. Leoni. 2007. <span>“Using Graphs
Instead of Tables in Political Science.”</span> <em>Perspectives on
Politics</em> 5 (4): 755–71.
</div>
<div id="ref-Wickham2009" class="csl-entry">
Wickham, Hadley. 2009. <em><span class="nocase">ggplot2</span>: Elegant
Graphics for Data Analysis</em>. New York: Springer. <a href="https://ggplot2-book.org/" class="external-link">https://ggplot2-book.org/</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Frederick Solt, Yue Hu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
